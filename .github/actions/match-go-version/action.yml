name: "Match Go Version"
description: "Compare project Go and golangci-lint versions with environment"

runs:
  using: "composite"
  steps:
    - name: Compare Go versions
      shell: bash
      run: |
        go_mod_version=$(awk '/^go / {print $2}' go.mod)

        version_output=$(go version)
        env_version=${version_output#go version go}
        env_version=${env_version%% *}

        echo "$go_mod_version=$env_version"
        if [[ "$go_mod_version" = "$env_version" ]]; then
          echo "true"
        else
          echo "false"
          exit 1
        fi

        golangci_file_version=$(cat .golangci-version)
        golangci_env_version=$(golangci-lint version --short)

        echo "$golangci_file_version=$golangci_env_version"
        if [[ "$golangci_file_version" = "$golangci_env_version" ]]; then
          echo "true"
        else
          echo "false"
          exit 1
        fi
